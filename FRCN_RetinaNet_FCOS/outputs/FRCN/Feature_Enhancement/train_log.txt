WARNING:torch.distributed.run:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
| distributed init (rank 1): env://
| distributed init (rank 0): env://
Namespace(data_path='/media/data/coco2017', weights_path=None, dataset='coco', model='my_fasterrcnn_resnet50_fpn', device='cuda', batch_size=2, epochs=26, workers=4, opt='sgd', lr=0.005, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, lr_scheduler='multisteplr', lr_step_size=8, lr_steps=[16, 22], lr_gamma=0.1, print_freq=20, output_dir='./outputs/FRCN/Feature_Enhancement', resume='', start_epoch=0, aspect_ratio_group_factor=3, rpn_score_thresh=None, trainable_backbone_layers=None, data_augmentation='hflip', sync_bn=False, test_only=False, use_deterministic_algorithms=False, world_size=2, dist_url='env://', weights=None, weights_backbone='ResNet50_Weights.IMAGENET1K_V1', amp=True, use_copypaste=False, backend='pil', use_v2=False, rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
root:  /media/data/coco2017
img_folder:  train2017
loading annotations into memory...
Done (t=8.51s)
creating index...
index created!
root:  /media/data/coco2017
img_folder:  val2017
loading annotations into memory...
Done (t=0.21s)
creating index...
index created!
Creating data loaders
Using [0, 0.5, 0.6299605249474365, 0.7937005259840997, 1.0, 1.259921049894873, 1.5874010519681991, 2.0, inf] as bins for aspect ratio quantization
Count of instances per bin: [  104   982 24236  2332  8225 74466  5763  1158]
Creating model
extra_blocks: LastLevelMaxPool()
Loading weights from ResNet50_Weights.IMAGENET1K_V1
Traceback (most recent call last):
  File "/home/hslee/Feature_Enhancement/FRCN_RetinaNet_FCOS/train.py", line 357, in <module>
    main(args)
  File "/home/hslee/Feature_Enhancement/FRCN_RetinaNet_FCOS/train.py", line 261, in main
    model.to(device)
    ^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'to'
extra_blocks: LastLevelMaxPool()
Traceback (most recent call last):
  File "/home/hslee/Feature_Enhancement/FRCN_RetinaNet_FCOS/train.py", line 357, in <module>
    main(args)
  File "/home/hslee/Feature_Enhancement/FRCN_RetinaNet_FCOS/train.py", line 261, in main
    model.to(device)
    ^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'to'
ERROR:torch.distributed.elastic.multiprocessing.api:failed (exitcode: 1) local_rank: 0 (pid: 2234855) of binary: /home/hslee/anaconda3/bin/python
Traceback (most recent call last):
  File "/home/hslee/anaconda3/bin/torchrun", line 33, in <module>
    sys.exit(load_entry_point('torch==2.0.1', 'console_scripts', 'torchrun')())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hslee/anaconda3/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/hslee/anaconda3/lib/python3.11/site-packages/torch/distributed/run.py", line 794, in main
    run(args)
  File "/home/hslee/anaconda3/lib/python3.11/site-packages/torch/distributed/run.py", line 785, in run
    elastic_launch(
  File "/home/hslee/anaconda3/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/hslee/anaconda3/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 250, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-10-01_20:35:03
  host      : pascal
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 2234856)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-10-01_20:35:03
  host      : pascal
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 2234855)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
